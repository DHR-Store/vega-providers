"use strict";var __awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=function(t){return __awaiter(this,arguments,void 0,function*({link:t,type:e,providerContext:i}){try{const{axios:n,cheerio:r,extractors:o}=i,{superVideoExtractor:a}=o;function s(t){return __awaiter(this,arguments,void 0,function*({imdb:t}){try{const e="https://guardahd.stream"+("/set-movie-a/"+t),i=(yield n.get(e,{timeout:4e3})).data,o=r.load(i)('li:contains("supervideo")').attr("data-link");if(!o)return null;const s=new AbortController,u=s.signal;setTimeout(()=>s.abort(),4e3);const c=yield fetch("https:"+o,{signal:u}),d=yield c.text();return yield a(d)}catch(t){}})}function u(t){return __awaiter(this,arguments,void 0,function*({imdb:t,type:e,season:i,episode:o}){try{const s="https://mostraguarda.stream"+("tv"===e?`/serie/${t}/${i}/${o}`:`/movie/${t}`),u=(yield n(s,{timeout:4e3})).data,c=r.load(u)('li:contains("supervideo")').attr("data-link");if(!c)return null;const d=new AbortController,l=d.signal;setTimeout(()=>d.abort(),4e3);const p=yield fetch("https:"+c,{signal:l}),y=yield p.text();return yield a(y)}catch(t){}})}const c=[],{imdbId:d,season:l,episode:p}=JSON.parse(t),y=yield u({imdb:d,type:e,season:l,episode:p});y&&c.push({server:"Supervideo 1",link:y,type:"m3u8"});const h=yield s({imdb:d,type:e,season:l,episode:p});return h&&c.push({server:"Supervideo 2",link:h,type:"m3u8"}),c}catch(m){return[]}})};exports.getStream=getStream;