"use strict";var __awaiter=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(s,o){function n(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(n,a)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSearchPosts=exports.getPosts=void 0;const getPosts=function(t){return __awaiter(this,arguments,void 0,function*({filter:t,page:e,signal:r,providerContext:i}){const{getBaseUrl:s,axios:o,cheerio:n}=i,a=yield s("tokyoinsider");return posts({baseURL:a,url:`${a}/${t}&start=${e<2?0:20*(e-1)}`,signal:r,axios:o,cheerio:n})})};exports.getPosts=getPosts;const getSearchPosts=function(t){return __awaiter(this,arguments,void 0,function*({searchQuery:t,page:e,signal:r,providerContext:i}){const{getBaseUrl:s,axios:o,cheerio:n}=i,a=yield s("tokyoinsider");return posts({baseURL:a,url:`${a}/anime/search?k=${t}&start=${e<2?0:20*(e-1)}`,signal:r,axios:o,cheerio:n})})};function posts(t){return __awaiter(this,arguments,void 0,function*({baseURL:t,url:e,signal:r,axios:i,cheerio:s}){try{const o=(yield i.get(e,{signal:r})).data,n=s.load(o),a=[];return n('td.c_h2[width="40"]').map((e,r)=>{var i;const s=null===(i=n(r).find(".a_img").attr("src"))||void 0===i?void 0:i.replace("small","default"),o=n(r).find("a").attr("title"),c=t+n(r).find("a").attr("href");o&&c&&s&&a.push({title:o,link:c,image:s})}),a}catch(t){return[]}})}exports.getSearchPosts=getSearchPosts;