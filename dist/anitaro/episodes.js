"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=void 0;const getEpisodes=async function({url:url,providerContext:providerContext}){var _a,_b,_c;const{axios:axios,cheerio:cheerio,commonHeaders:commonHeaders}=providerContext;try{const detailRes=await axios.get(url,{headers:commonHeaders}),$=cheerio.load(detailRes.data),title=$("h2.film-name").text().trim()||$("h1").first().text().trim();if(!title)return[];const searchApi="https://dwnld.justanime.to/api/search?q="+encodeURIComponent(title),firstResult=null===(_b=null===(_a=(await axios.get(searchApi)).data)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b[0];if(!(null==firstResult?void 0:firstResult.session))return[];const animeSession=firstResult.session,releasesApi=`https://dwnld.justanime.to/api/${animeSession}/releases?page=1`,releases=(null===(_c=(await axios.get(releasesApi)).data)||void 0===_c?void 0:_c.data)||[];if(!releases.length)return[];return releases.sort((a,b)=>a.episode-b.episode).map(ep=>({title:`Episode ${ep.episode}`,link:`https://dwnld.justanime.to/api/play/${animeSession}?episodeId=${ep.session}`}))}catch(err){return[]}};exports.getEpisodes=getEpisodes;