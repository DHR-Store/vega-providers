"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const getMeta=function(_a){return __awaiter(this,arguments,void 0,function*({link:link,providerContext:providerContext}){try{const{axios:axios,cheerio:cheerio}=providerContext,url=link,res=yield axios.get(url,{headers:providerContext.commonHeaders}),$=cheerio.load(res.data||""),base="https://hdmovie2.africa",title=$("h1.entry-title, h1.post-title, h1").first().text().trim()||$("meta[property='og:title']").attr("content")||$("title").text().split("|")[0].trim()||"",synopsis=$("div.synopsis, .summary, .entry-content p").first().text().trim()||$("meta[name='description']").attr("content")||"";let image=$("meta[property='og:image']").attr("content")||$("img.wp-post-image").attr("src")||$("img.featured, .poster img, .cover img").attr("src")||"";image.startsWith("/")&&(image=base+image);const tags=[];$("a[rel='tag'], .tags a, .post-categories a, .genres a").each((i,el)=>{const t=$(el).text().trim();t&&tags.push(t)});let rating=$("span.rating, .rating, .imdb, .imdbRatingValue strong, .ratingValue").first().text().trim()||$("meta[itemprop='ratingValue']").attr("content")||"";const ratingMatch=rating.match(/\d+(\.\d+)?/);rating=ratingMatch?ratingMatch[0]:"";const links=[];$("a").each((i,el)=>{const $el=$(el);let href=$el.attr("href")||$el.data("href")||"";if(!href){const onclick=$el.attr("onclick");if(onclick){const match=onclick.match(/'(https?:\/\/[^']+)'/);match&&(href=match[1])}}if(!href)return;let titleText=$el.text().trim()||$el.attr("title")||"Link",quality="";const qMatch=titleText.match(/(\d{3,4}P|4K|HD|1080|720)/i);qMatch&&(quality=qMatch[0].toUpperCase());let directLinkType="episode";const lowerTitle=titleText.toLowerCase(),lowerHref=href.toLowerCase();(lowerTitle.includes("play")||lowerTitle.includes("stream")||lowerHref.includes("embed")||lowerHref.includes("player")||lowerTitle.includes("download")||lowerTitle.includes("dl")||lowerHref.includes(".mp4")||lowerHref.includes(".mkv"))&&(directLinkType="episode"),links.push({title:titleText,episodesLink:href.startsWith("/")?base+href:href,quality:quality||"HD",directLinks:[{title:titleText,link:href.startsWith("/")?base+href:href,quality:quality||"HD",type:directLinkType}]})});const mediaType=title.toLocaleLowerCase().includes("season")?"series":"movie";return{title:title||"",synopsis:synopsis||"",image:image||"",imdbId:"",type:mediaType,linkList:links,tags:tags,rating:rating}}catch(err){return{title:"",synopsis:"",image:"",imdbId:"",type:"movie",linkList:[],tags:[],rating:""}}})};exports.getMeta=getMeta;
