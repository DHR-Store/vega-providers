"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=async function({link:url,type:type,signal:signal,providerContext:providerContext}){var _a,_b;const headers=providerContext.commonHeaders;try{if("movie"===type){const html=(await providerContext.axios.get(url,{headers:headers})).data,$=providerContext.cheerio.load(html);url=$('a:contains("HubCloud")').attr("href")||url}const res=await providerContext.axios.get(url,{headers:headers});let redirectUrl=null===(_a=res.data.match(/<meta\s+http-equiv="refresh"\s+content="[^"]*?;\s*url=([^"]+)"\s*\/?>/i))||void 0===_a?void 0:_a[1];if(url.includes("/archives/")&&(redirectUrl=null===(_b=res.data.match(/<a\s+[^>]*href="(https:\/\/hubcloud\.[^\/]+\/[^"]+)"/i))||void 0===_b?void 0:_b[1]),!redirectUrl)return await providerContext.extractors.hubcloudExtracter(url,signal);const data=(await providerContext.axios.get(redirectUrl,{headers:headers})).data,hubcloudLink=providerContext.cheerio.load(data)(".fa-file-download").parent().attr("href");return await providerContext.extractors.hubcloudExtracter((null==hubcloudLink?void 0:hubcloudLink.includes("https://hubcloud"))?hubcloudLink:redirectUrl,signal)}catch(err){return[]}};exports.getStream=getStream;