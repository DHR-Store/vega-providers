"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,o){function n(e){try{c(a.next(e))}catch(e){o(e)}}function i(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}c((a=a.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSearchPosts=exports.getPosts=void 0;const getPosts=function(e){return __awaiter(this,arguments,void 0,function*({filter:e,page:t,signal:r,providerContext:a}){const{getBaseUrl:s,axios:o,cheerio:n}=a,i=yield s("protonMovies");return posts({url:`${i+e}/page/${t}/`,baseUrl:i,signal:r,axios:o,cheerio:n})})};exports.getPosts=getPosts;const getSearchPosts=function(e){return __awaiter(this,arguments,void 0,function*({searchQuery:e,page:t,signal:r,providerContext:a}){const{getBaseUrl:s,axios:o,cheerio:n}=a,i=yield s("protonMovies");return posts({url:`${i}/search/${e}/page/${t}/`,baseUrl:i,signal:r,axios:o,cheerio:n})})};function posts(e){return __awaiter(this,arguments,void 0,function*({url:e,baseUrl:t,signal:r,axios:a,cheerio:s}){try{const o=(yield a.get(e,{headers:{referer:t},signal:r})).data,n=/\[(?=.*?"<div class")(.*?)\]/g,i=null==o?void 0:o.match(n),c=JSON.parse(i[i.length-1]).join("").replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\r/g,"\r").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),l=s.load(c),g=[];return l(".col.mb-4").map((e,t)=>{const r=l(t).find("h5").text(),a=l(t).find("h5").find("a").attr("href"),s=l(t).find("img").attr("data-src")||l(t).find("img").attr("src")||"";r&&a&&s&&g.push({title:r,link:a,image:s})}),g}catch(e){return[]}})}exports.getSearchPosts=getSearchPosts;