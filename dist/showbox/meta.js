"use strict";var __awaiter=this&&this.__awaiter||function(i,t,e,n){return new(e||(e=Promise))(function(o,l){function a(i){try{s(n.next(i))}catch(i){l(i)}}function d(i){try{s(n.throw(i))}catch(i){l(i)}}function s(i){var t;i.done?o(i.value):(t=i.value,t instanceof e?t:new e(function(i){i(t)})).then(a,d)}s((n=n.apply(i,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const getMeta=function(i){return __awaiter(this,arguments,void 0,function*({link:i,providerContext:t}){var e,n,o,l,a,d,s,r,v;try{const{axios:u,cheerio:c,getBaseUrl:p}=t,f=(yield p("showbox"))+i,h=(yield u.get(f)).data,_=c.load(h),g=f.includes("tv")?"series":"movie",m="",y=_(".heading-name").text(),x=(null===(n=null===(e=_(".btn-imdb").text())||void 0===e?void 0:e.match(/\d+(\.\d+)?/g))||void 0===n?void 0:n[0])||"",w=(null===(l=null===(o=_(".cover_follow").attr("style"))||void 0===o?void 0:o.split("url(")[1])||void 0===l?void 0:l.split(")")[0])||"",$=null===(d=null===(a=_(".description").text())||void 0===a?void 0:a.replace(/[\n\t]/g,""))||void 0===d?void 0:d.trim(),b=null===(r=null===(s=_(".heading-name").find("a").attr("href"))||void 0===s?void 0:s.split("/"))||void 0===r?void 0:r.pop(),k=`${f.split("/").slice(0,3).join("/")}/index/share_link?id=${b}&type=${"movie"===g?"1":"2"}`,M=yield u.get(k),L=M.data.data.link.split("/").pop(),j=`https://www.febbox.com/file/file_share_list?share_key=${L}&is_html=0`,I=(yield u.get(j)).data,P=null===(v=null==I?void 0:I.data)||void 0===v?void 0:v.file_list,z=[];return P&&P.map(i=>{const t=`${i.file_name} (${i.file_size})`,e=i.fid;z.push({title:t,episodesLink:i.is_dir?`${L}&${e}`:`${L}&`})}),{title:y,rating:x,synopsis:$,image:w,imdbId:m,type:g,linkList:z}}catch(i){return{title:"",rating:"",synopsis:"",image:"",imdbId:"",type:"",linkList:[]}}})};exports.getMeta=getMeta;