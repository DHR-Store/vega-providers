"use strict";var __awaiter=this&&this.__awaiter||function(e,t,a,c){return new(a||(a=Promise))(function(i,n){function o(e){try{s(c.next(e))}catch(e){n(e)}}function r(e){try{s(c.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(o,r)}s((c=c.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=e=>__awaiter(void 0,[e],void 0,function*({link:e,signal:t,providerContext:a}){var c;try{let i=e;if(e.includes("linkstore")){const a=yield fetch(e,{signal:t,headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9,en-IN;q=0.8","cache-control":"no-cache",pragma:"no-cache",priority:"u=0, i","sec-ch-ua":'"Microsoft Edge";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1",cookie:"PHPSESSID=9o57cff841dqtv8djtn1rp1712; ext_name=ojplmecpdpgccookcobabopnaifgidhf"}}),c=(yield a.text()).match(/<meta\s+http-equiv="refresh"\s+content="[^"]*url=([^"]+)"/i);c&&c[1]&&(e=c[1])}if(e.includes("luxedrive")){const c=yield a.axios.get(e,{signal:t}),n=a.cheerio.load(c.data),o=n("a.btn.hubcloud").attr("href");if(o)i=o;else{const e=n("a.btn.gdflix").attr("href");e&&(i=e)}}if(i.includes("flix")){return yield a.extractors.gdFlixExtracter(i,t)}const n=yield a.axios.get(i,{signal:t}),o=(null===(c=n.data.match(/location\.replace\('([^']+)'/))||void 0===c?void 0:c[1])||i;return yield a.extractors.hubcloudExtracter(o.includes("https://hubcloud")?o:i,t)}catch(e){return[]}});exports.getStream=getStream;