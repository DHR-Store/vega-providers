"use strict";function base64Decode(str){const cleanedStr=str.replace(/\s/g,"");try{const binaryStr=atob(cleanedStr);return decodeURIComponent(binaryStr.split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}catch(e){return""}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=void 0;const getEpisodes=function({url:url,providerContext:providerContext}){const{axios:axios,cheerio:cheerio,commonHeaders:headers}=providerContext;return axios.get(url,{headers:headers}).then(res=>{let $=cheerio.load(res.data);const episodes=[],scriptContent=$("script").filter((i,el)=>{var _a,_b;return null!==(_b=null===(_a=$(el).html())||void 0===_a?void 0:_a.includes('const encoded = "'))&&void 0!==_b&&_b}).html();let encodedContent="";if(scriptContent){const match=scriptContent.match(/const encoded = "([^"]+)"/);match&&match[1]&&(encodedContent=match[1])}let decodedContent="";encodedContent&&(decodedContent=base64Decode(encodedContent));const fullHtml=res.data+decodedContent;$=cheerio.load(fullHtml);$(".entry-content, .entry-inner").find("h4, h3").each((_,element)=>{const el=$(element);let titleMatch=el.text().match(/-:Episodes: (\d+):-/);const episodeNumber=titleMatch?titleMatch[1]:"";if(!episodeNumber)return;const finalTitle=`Episode ${episodeNumber}`;el.next("p").find("a[href*='vcloud']").each((_,a)=>{var _a;const href=null===(_a=$(a).attr("href"))||void 0===_a?void 0:_a.trim();href&&episodes.push({title:finalTitle,link:href})})});return Array.from(new Set(episodes.map(e=>e.link))).map(link=>episodes.find(e=>e.link===link))}).catch(err=>[])};exports.getEpisodes=getEpisodes;