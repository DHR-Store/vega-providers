"use strict";var __awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,s){function a(t){try{l(o.next(t))}catch(t){s(t)}}function r(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,r)}l((o=o.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSearchPosts=exports.getPosts=void 0;const getPosts=function(t){return __awaiter(this,arguments,void 0,function*({filter:t,signal:e,providerContext:n}){try{const o=[],i="https://cinemeta-catalogs.strem.io"+t,s=(yield n.axios.get(i,{headers:n.commonHeaders,signal:e})).data;return null==s||s.metas.map(t=>{const e=null==t?void 0:t.name,n=(null==t?void 0:t.imdb_id)||(null==t?void 0:t.id),i=null==t?void 0:t.type,s=null==t?void 0:t.poster;n&&o.push({title:e,link:`https://v3-cinemeta.strem.io/meta/${i}/${n}.json`,image:s})}),o}catch(t){return[]}})};exports.getPosts=getPosts;const getSearchPosts=function(t){return __awaiter(this,arguments,void 0,function*({searchQuery:t,page:e,signal:n,providerContext:o}){try{if(e>1)return[];const i=[],s=`https://v3-cinemeta.strem.io/catalog/series/top/search=${encodeURI(t)}.json`,a=`https://v3-cinemeta.strem.io/catalog/movie/top/search=${encodeURI(t)}.json`,r=(yield o.axios.get(s,{headers:o.commonHeaders,signal:n})).data;null==r||r.metas.map(t=>{const e=t.name||"",n=(null==t?void 0:t.imdb_id)||(null==t?void 0:t.id),o=null==t?void 0:t.poster,s=null==t?void 0:t.type;n&&i.push({title:e,link:`https://v3-cinemeta.strem.io/meta/${s}/${n}.json`,image:o})});const l=(yield o.axios.get(a,{headers:o.commonHeaders,signal:n})).data;return null==l||l.metas.map(t=>{const e=(null==t?void 0:t.name)||"",n=(null==t?void 0:t.imdb_id)||(null==t?void 0:t.id),o=null==t?void 0:t.poster,s=null==t?void 0:t.type;n&&i.push({title:e,link:`https://v3-cinemeta.strem.io/meta/${s}/${n}.json`,image:o})}),i}catch(t){return[]}})};exports.getSearchPosts=getSearchPosts;